// new index (1).html (Ø¯Ø§Ø®Ù„ ÙˆØ³Ù… <script>)
// (ÙŠØ¬Ø¨ ØªØ¹Ø±ÙŠÙ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØºÙŠØ± ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù„Ù…Ù„Ù JS)
let appliedCodeId = null; 

// ===================================
// ğŸ« Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ (Player Flow)
// ===================================

window.validateVoucher = async function(fieldId) {
    const codeValue = document.getElementById('voucherCodeInput').value.trim();
    const resultContainer = document.getElementById('voucherResult');
    
    if (!codeValue) {
        resultContainer.innerHTML = '';
        appliedCodeId = null;
        // ÙŠØ¬Ø¨ Ù‡Ù†Ø§ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø¬Ø² ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
        return; 
    }
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    window.showLoading(true);

    try {
        const response = await apiRequest("/api/codes/validate", 'POST', { 
            codeValue, 
            fieldId 
        });

        appliedCodeId = response.codeId;
        window.showLoading(false);
        
        let discountText = '';
        if (response.discountType === 'percent') {
            discountText = `Ø®ØµÙ…: ${response.discountValue}%`;
        } else if (response.discountType === 'fixed') {
            discountText = `Ø®ØµÙ…: ${response.discountValue} Ø¬.Ù…`;
        }
        
        resultContainer.innerHTML = `
            <div class="alert alert-success p-2 small m-0">
                âœ… ${response.message} (${discountText})
            </div>
        `;
        // ÙŠØ¬Ø¨ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø¬Ø² ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…
        updateBookingSummary(response); 

    } catch (error) {
        window.showLoading(false);
        appliedCodeId = null;
        resultContainer.innerHTML = `
            <div class="alert alert-danger p-2 small m-0">
                âŒ ${error.message || 'Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­.'}
            </div>
        `;
        updateBookingSummary(null);
    }
}

// ===================================
// âš½ ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø¬Ø² (bookStadium)
// ===================================
// ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ø±Ù Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø·Ø¨Ù‚ Ù…Ø¹ Ø·Ù„Ø¨ Ø§Ù„Ø­Ø¬Ø²

window.bookStadium = async function(fieldId, bookingDate, startTime, endTime) {
    // ... (Ø¬Ù„Ø¨ playersNeeded)
    
    const data = {
        fieldId,
        bookingDate,
        startTime,
        endTime,
        playersNeeded,
        codeId: appliedCodeId // <-- Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø±Ù Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø°ÙŠ ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡
    };
    
    // ... (Ø¨Ù‚ÙŠØ© Ù…Ù†Ø·Ù‚ bookStadiumController Ø§Ù„Ø°ÙŠ ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡ Ø³Ø§Ø¨Ù‚Ø§Ù‹)
    try {
        const response = await apiRequest("/api/booking/request", 'POST', data);
        // ... (Ù…Ù†Ø·Ù‚ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø¯ÙØ¹ Ø£Ùˆ Ø¹Ø±Ø¶ Ø§Ù„ØªØ£ÙƒÙŠØ¯)
    } catch (error) {
        // ...
    }
}

// Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ (voucherCodeInput) ÙˆÙˆØ¹Ø§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (voucherResult) ÙˆØ²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†.

// new index (1).html (Ø¯Ø§Ø®Ù„ ÙˆØ³Ù… <script>)
// (ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ù„Ø© apiRequest ÙÙŠ Ù†Ø·Ø§Ù‚ Ø§Ù„ÙˆØµÙˆÙ„)

/**
 * ØªØ¨Ø¯Ø£ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø¬Ø² ÙˆØªØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ø¯ÙØ¹ Ø¹Ø±Ø¨ÙˆÙ†
 * ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø³Ø§Ø¹Ø© Ù…ØªØ§Ø­Ø©
 */
window.bookStadium = async function(fieldId, bookingDate, startTime, endTime) {
    // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¯Ø§Ù„ (Modal) Ù‡Ù†Ø§ Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
    // (Ø³Ù†ÙØªØ±Ø¶ ÙˆØ¬ÙˆØ¯ Ø¹Ù†ØµØ± Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¥Ø¶Ø§ÙÙŠÙŠÙ†)
    const playersNeededInput = document.getElementById('playersNeededInput');
    const playersNeeded = playersNeededInput ? parseInt(playersNeededInput.value) || 0 : 0; 
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
    window.showLoading(true); 

    try {
        const response = await apiRequest("/api/booking/request", 'POST', {
            fieldId,
            bookingDate,
            startTime,
            endTime,
            playersNeeded
        });

        window.showLoading(false);
        
        if (response.requiresPayment) {
            // ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ Ù„Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†
            window.showToast("ØªÙ… Ø­Ø¬Ø² Ø§Ù„Ø³Ø§Ø¹Ø© Ù…Ø¨Ø¯Ø¦ÙŠØ§Ù‹. Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø¯ÙØ¹...", 'info');
            // ØªØ£ÙƒØ¯ Ø£Ù† /payment.html Ù‡Ùˆ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­
            setTimeout(() => {
                window.location.href = `/payment.html?bookingId=${response.bookingId}`;
            }, 1000);
        } else {
            // Ø­Ø¬Ø² Ù…Ø¹Ù„Ù‚ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ø¯ÙØ¹ Ø¹Ø±Ø¨ÙˆÙ† (Ø£Ù‚Ù„ Ù…Ù† 24 Ø³Ø§Ø¹Ø©)
            window.showToast(response.message, 'info');
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù„Ø¹Ø¨ Ù„Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© "Pending" Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            // (ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† loadStadiumDetails Ù…ÙØ¹Ø±Ù‘ÙØ© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù)
            loadStadiumDetails(fieldId); 
        }
    } catch (error) {
        window.showLoading(false);
        window.showToast(`ÙØ´Ù„ Ø§Ù„Ø­Ø¬Ø²: ${error.message}`, 'error');
    }
}
// ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø§Ù„Ø© Ø¥Ù„Ù‰ appHelpers Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Ù†Ù…Ø· Ø§Ù„ØªØµØ¯ÙŠØ± Ù‡Ø°Ø§
if (window.appHelpers) {
    window.appHelpers.bookStadium = window.bookStadium;
}

// new index (1).html (Ø¯Ø§Ø®Ù„ Ø¯Ø§Ù„Ø© showStadiumPopup)

async function showStadiumPopup(stadiumId) {
    // ... Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù„Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø¹Ø¨ ÙˆØ§Ù„Ø³Ø§Ø¹Ø§Øª ...
    
    // =====================================
    // ğŸ†• Ø¬Ù„Ø¨ ÙˆØ¹Ø±Ø¶ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù„Ø¹Ø¨
    // =====================================
    const ratingsContainer = document.getElementById('popupRatings');
    const avgRatingElement = document.getElementById('popupAvgRating');
    
    try {
        const ratingsResponse = await fetch(`/api/fields/${stadiumId}/ratings`);
        if (!ratingsResponse.ok) throw new Error('ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª');
        
        const ratings = await ratingsResponse.json();
        
        // Ø¬Ù„Ø¨ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ù† ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„ØªÙŠ ØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ù…Ø³Ø¨Ù‚Ø§Ù‹
        // (ÙŠÙØªØ±Ø¶ Ø£Ù† ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø¹Ø¨ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ average_rating)
        const avgRating = stadiumDetails.average_rating ? parseFloat(stadiumDetails.average_rating).toFixed(1) : 'Ø¬Ø¯ÙŠØ¯';
        
        avgRatingElement.innerHTML = `â­ ${avgRating} <small class="text-muted">(${ratings.length} ØªÙ‚ÙŠÙŠÙ…)</small>`;

        ratingsContainer.innerHTML = ratings.map(r => `
            <div class="rating-item mb-2 p-2 border-bottom">
                <p class="mb-0">
                    <strong class="text-dark">${r.reviewer_name}:</strong> 
                    <span class="badge bg-warning">${'â­'.repeat(r.rating_value)}</span>
                </p>
                <small class="text-muted">${r.comment || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚.'}</small>
            </div>
        `).join('');
        
    } catch (error) {
        ratingsContainer.innerHTML = '<p class="text-danger small">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª.</p>';
        avgRatingElement.innerHTML = 'â­ N/A';
    }

    // ... Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© ...
}

2. ğŸ–¥ï¸ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© (UI)
Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØªÙˆÙÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù„Ø§Ø²Ù… Ù„Ù‡Ø§ ÙÙŠ Ù…Ù„Ù Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (new index (1).html).

Ø£. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙÙŠ Ø§Ù„Ù‡ÙŠÙƒÙ„ (HTML)
ÙÙŠ Ù…Ù„Ù new index (1).html (Ø£Ùˆ Ù…Ù„Ù Ø§Ù„Ù€ Header Ø§Ù„Ù…Ø´ØªØ±Ùƒ)ØŒ Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø¨Ø¬ÙˆØ§Ø± Ø²Ø± "Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ":

HTML

<div class="notifications-dropdown" style="position:relative; margin-left: 16px;">
    <button class="btn btn-light position-relative" id="notificationsToggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" onclick="appHelpers.loadNotifications()">
        <i class="bi bi-bell-fill fs-5"></i>
        <span id="notificationBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display:none;">
            0 
            <span class="visually-hidden">Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</span>
        </span>
    </button>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationsToggle" id="notificationsList" style="min-width: 300px; max-height: 400px; overflow-y: auto;">
        <li><a class="dropdown-item text-center text-muted" href="#" onclick="appHelpers.markAllAsRead(event)">ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© 'Ù…Ù‚Ø±ÙˆØ¡' Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„</a></li>
    </ul>
</div>
Ø¨. Ù…Ù†Ø·Ù‚ JavaScript
Ø£Ø¶Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ§Ù„ ÙÙŠ ÙˆØ³Ù… <script> Ø¨Ù…Ù„Ù new index (1).html ÙˆÙ‚Ù… Ø¨ØªØ¶Ù…ÙŠÙ†Ù‡Ø§ ÙÙŠ ÙƒØ§Ø¦Ù† appHelpers:

JavaScript

// new index (1).html (Ø¯Ø§Ø®Ù„ ÙˆØ³Ù… <script> ÙˆÙÙŠ ÙƒØ§Ø¦Ù† appHelpers)

// ===================================
// ğŸ”” Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Notifications)
// ===================================

/**
 * 1. Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
 */
async function loadNotifications() {
    const badge = document.getElementById('notificationBadge');
    const list = document.getElementById('notificationsList');
    
    try {
        // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© ØªØ­Ù…ÙŠÙ„ Ø¨Ø³ÙŠØ·Ø© Ø£Ùˆ Ù†Øµ "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„"
        list.innerHTML = '<li><span class="dropdown-item text-center text-info">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span></li>';
        
        const response = await apiRequest("/api/notifications", 'GET');
        const { notifications, unreadCount } = response;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
        if (unreadCount > 0) {
            badge.textContent = unreadCount;
            badge.style.display = 'block';
        } else {
            badge.style.display = 'none';
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        list.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚Ø¯ÙŠÙ…
        
        if (notifications.length === 0) {
            list.innerHTML = '<li><span class="dropdown-item text-muted text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.</span></li>';
        } else {
            notifications.forEach(n => {
                const item = document.createElement('li');
                // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø¯Ø§ÙƒÙ† Ø£Ùˆ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„ÙØ§ØªØ­Ø©
                item.innerHTML = `<a class="dropdown-item ${n.is_read ? 'text-muted' : 'fw-bold bg-light'}" href="#">
                    <i class="bi bi-bell${n.is_read ? '' : '-fill'}"></i> ${n.message}
                    <span class="d-block small text-end mt-1 text-secondary">${new Date(n.created_at).toLocaleString('ar-EG')}</span>
                </a>`;
                list.appendChild(item);
            });
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø²Ø± "ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ù…Ù‚Ø±ÙˆØ¡" (ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©)
        list.innerHTML += '<li><hr class="dropdown-divider"></li>';
        list.innerHTML += `<li><a class="dropdown-item text-center text-muted" href="#" onclick="appHelpers.markAllAsRead(event)">ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© 'Ù…Ù‚Ø±ÙˆØ¡' Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„</a></li>`;

    } catch (error) {
        console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª:', error);
        list.innerHTML = '<li><span class="dropdown-item text-danger">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.</span></li>';
    }
}

/**
 * 2. ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© 'Ù…Ù‚Ø±ÙˆØ¡' Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
 */
async function markAllAsRead(event) {
    if(event) event.preventDefault();
    try {
        window.showLoading(true);
        await apiRequest("/api/notifications/mark-all-read", 'POST');
        window.showLoading(false);
        window.showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.', 'info');
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ø¹Ø±Ø¶
        loadNotifications(); 
    } catch (error) {
        window.showLoading(false);
        window.showToast('ÙØ´Ù„ ÙÙŠ ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© 'Ù…Ù‚Ø±ÙˆØ¡'.', 'error');
    }
}

/**
 * 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯ (Ù„Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯ÙˆØ±ÙŠ)
 */
async function checkUnreadCount() {
    try {
        const response = await apiRequest("/api/notifications", 'GET');
        const unreadCount = response.unreadCount;
        
        const badge = document.getElementById('notificationBadge');
        if (badge) {
             if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.style.display = 'block';
            } else {
                badge.style.display = 'none';
            }
        }
    } catch (error) {
        console.error('ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª:', error);
    }
}

// 4. ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„ØªÙƒÙˆÙ† Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
window.appHelpers = {
    // ... (ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø®Ø±Ù‰)
    loadNotifications,
    markAllAsRead,
    checkUnreadCount
};

// 5. Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ checkUnreadCount Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
// document.addEventListener('DOMContentLoaded', () => {
//    if (appHelpers.checkAuthStatus()) {
//        appHelpers.checkUnreadCount(); 
//        // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯ÙˆØ±ÙŠ Ù‡Ù†Ø§:
//        // setInterval(appHelpers.checkUnreadCount, 60000); 
//    }
// });
Ø¨Ø°Ù„Ùƒ Ù†ÙƒÙˆÙ† Ù‚Ø¯ Ø§Ù†ØªÙ‡ÙŠÙ†Ø§ Ù…Ù† Ø¨Ù†Ø§Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.
